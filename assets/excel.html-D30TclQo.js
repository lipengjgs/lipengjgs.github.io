import{_ as i,c as s,o as a,e as h}from"./app-DLxUEbjT.js";const n={},k=h(`<h2 id="利用-vba-分割-excel大文件-多行按固定行数分成多个文件" tabindex="-1"><a class="header-anchor" href="#利用-vba-分割-excel大文件-多行按固定行数分成多个文件"><span>利用 VBA 分割 Excel大文件 (多行按固定行数分成多个文件)</span></a></h2><div class="language-vb line-numbers-mode" data-highlighter="shiki" data-ext="vb" data-title="vb" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">Sub</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> copybat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;--shiki-light-font-weight:bold;--shiki-dark-font-weight:inherit;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> j</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> k</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> m</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> r</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> As</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Integer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> n</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;--shiki-light-font-weight:bold;--shiki-dark-font-weight:inherit;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> total_data</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> As</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Long</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> path </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">As</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> String</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> title_area</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;--shiki-light-font-weight:bold;--shiki-dark-font-weight:inherit;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data_column</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data_areas</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> As</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Range</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">   </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    Set </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">title_area</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Application</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">InputBox</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">prompt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;请用鼠标选择表头及表标题所在区域&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Title</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;选择&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">&#39;选取表头区域</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    Set </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data_column</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Application</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">InputBox</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">prompt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;请鼠标选择需要拆分数据的开始行区域&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Title</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;选择&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">&#39;选取拆分起始处</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    m</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> data_column.Row      </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">&#39;获取分割开始行所在区域行号</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    r</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> data_column.Column   </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">&#39;获取分割开始行所在区域列号</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    j</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> data_column.Columns.Count   </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">&#39;获取分割开始行区域列数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    i</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Application</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">InputBox</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">prompt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;请输入每次分割数据条目数&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Title</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;选择&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   &#39;获取需要分割的数据总条数。这里，可以用两种办法获取到数据区域的尾部行号</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      &#39;第一种，使用传统的：End(xlDown).Row，优点是速度快，缺点是有空白行时会出错</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      &#39;第二种，使用查找方式find，优点是基本不会出错，缺点是条数较多时候可能会慢一点</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   &#39;total_data = Cells(data_column(1, 1)).End(xlDown).Row - m + 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    total_data</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> Cells.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Find</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> LookIn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">xlFormulas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> SearchDirection</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">xlPrevious</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">Row</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> m</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    If</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> MsgBox</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;本次分割文件数据总数为:&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> total_data</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &amp;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;条，将会被分割成&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> WorksheetFunction.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">RoundUp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">total_data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;个文件，&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> _</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">                &amp;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;点击“确定”开始分割，点击“取消”返回&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> vbOKCancel</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;确认&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> vbOK</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> Then</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">        Filename</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Application</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">InputBox</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">prompt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;请输入分割后的文件主名，默认为“分割文件”&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Title</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;选择&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Default</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;分割文件&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        With</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Application</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">FileDialog</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">msoFileDialogFolderPicker</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">&#39;获取分割后的文件存储路径</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">            If</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> .</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">Show</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> False</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> Then</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> Exit Sub</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">                path</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">SelectedItems</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;\\&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> &#39;加入&quot;\\&quot;,否则，文件会被存储到选定路径的上一层</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">        End</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> With</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">        Application</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ScreenUpdating</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> False</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">        k</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   &#39;第几次分割输出，用于标识分割文件次数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        For</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> n</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> m</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> To</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> total_data Step i   </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">&#39;从开始分割的行往下计数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">            Set </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data_areas</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Range</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Cells</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Cells</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> j</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">))   </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">&#39;设置每次循环体内的分割数据主体</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">            Application</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Union</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">title_area</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data_areas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">Select</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">           &#39;把表头区域以及本次循环体内的数据区域进行合并</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">            Selection.Copy</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">            Workbooks.</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">Add</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">            Selection.PasteSpecial Paste:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">xlPasteAllUsingSourceTheme</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Operation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">xlNone</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> _</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">            ,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> SkipBlanks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Transpose</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">False</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      &#39;特殊粘贴：包含源格式的粘贴，以便保持所有格式一致</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">           k</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> k</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">           ActiveWorkbook.SaveAs </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Filename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">path</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Filename</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &amp;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;_&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> k</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &amp;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;.xlsx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> FileFormat</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> _</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">            xlOpenXMLWorkbook,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> CreateBackup</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">False</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      &#39;按照既有的文件名、路径、循环次数合并起来存储文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">            ActiveWindow.Close</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        Next</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> n</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">        MsgBox</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;文件分割完毕！&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> vbDefaultButton1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;提示&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    End If</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">    Application</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ScreenUpdating</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> True</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">End Sub</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),l=[k];function t(p,e){return a(),s("div",null,l)}const B=i(n,[["render",t],["__file","excel.html.vue"]]),r=JSON.parse(`{"path":"/soft-engineering/tools/excel.html","title":"Excel","lang":"zh-CN","frontmatter":{"title":"Excel","footer":"","description":"利用 VBA 分割 Excel大文件 (多行按固定行数分成多个文件)","head":[["meta",{"property":"og:url","content":"https://lipengjgs.github.io/soft-engineering/tools/excel.html"}],["meta",{"property":"og:site_name","content":"SE Docs"}],["meta",{"property":"og:title","content":"Excel"}],["meta",{"property":"og:description","content":"利用 VBA 分割 Excel大文件 (多行按固定行数分成多个文件)"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-16T15:19:27.000Z"}],["meta",{"property":"article:author","content":"lipengjgs"}],["meta",{"property":"article:modified_time","content":"2024-08-16T15:19:27.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Excel\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-08-16T15:19:27.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"lipengjgs\\",\\"url\\":\\"\\"}]}"]]},"headers":[{"level":2,"title":"利用 VBA 分割 Excel大文件 (多行按固定行数分成多个文件)","slug":"利用-vba-分割-excel大文件-多行按固定行数分成多个文件","link":"#利用-vba-分割-excel大文件-多行按固定行数分成多个文件","children":[]}],"git":{"createdTime":1723821567000,"updatedTime":1723821567000,"contributors":[{"name":"jgs","email":"12345@qq.com","commits":1}]},"readingTime":{"minutes":1.98,"words":594},"filePathRelative":"soft-engineering/tools/excel.md","localizedDate":"2024年8月16日","autoDesc":true,"excerpt":"<h2>利用 VBA 分割 Excel大文件 (多行按固定行数分成多个文件)</h2>\\n<div class=\\"language-vb line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"vb\\" data-title=\\"vb\\" style=\\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes github-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">Sub</span><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\"> copybat</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">()</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">    Dim</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> i</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E06C75;--shiki-light-font-weight:bold;--shiki-dark-font-weight:inherit\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> j</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> k</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> m</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> r</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> As</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\"> Integer</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">    Dim</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> n</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E06C75;--shiki-light-font-weight:bold;--shiki-dark-font-weight:inherit\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> total_data</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> As</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\"> Long</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">    Dim</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> path </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">As</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\"> String</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">    Dim</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> title_area</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E06C75;--shiki-light-font-weight:bold;--shiki-dark-font-weight:inherit\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> data_column</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> data_areas</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> As</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\"> Range</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">   </span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">    Set </span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">title_area</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\"> Application</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">.</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\\">InputBox</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">prompt</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"请用鼠标选择表头及表标题所在区域\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> Title</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"选择\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> Type</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">8</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">) </span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">'选取表头区域</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">    Set </span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">data_column</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\"> Application</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">.</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\\">InputBox</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">prompt</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"请鼠标选择需要拆分数据的开始行区域\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> Title</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"选择\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> Type</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">8</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">) </span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">'选取拆分起始处</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">    m</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> data_column.Row      </span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">'获取分割开始行所在区域行号</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">    r</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> data_column.Column   </span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">'获取分割开始行所在区域列号</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">    j</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> data_column.Columns.Count   </span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">'获取分割开始行区域列数</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">    i</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\"> Application</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">.</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\\">InputBox</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">prompt</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"请输入每次分割数据条目数\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> Title</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"选择\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">)</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">  </span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">   '获取需要分割的数据总条数。这里，可以用两种办法获取到数据区域的尾部行号</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">      '第一种，使用传统的：End(xlDown).Row，优点是速度快，缺点是有空白行时会出错</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">      '第二种，使用查找方式find，优点是基本不会出错，缺点是条数较多时候可能会慢一点</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">   'total_data = Cells(data_column(1, 1)).End(xlDown).Row - m + 1</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">    total_data</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> Cells.</span><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">Find</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"*\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> LookIn</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">xlFormulas</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> SearchDirection</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">xlPrevious</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">).</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">Row</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> -</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> m</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> +</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\"> 1</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">    If</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\\"> MsgBox</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"本次分割文件数据总数为:\\"</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> &amp;</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> total_data</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> &amp;</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"条，将会被分割成\\"</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> &amp;</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> WorksheetFunction.</span><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">RoundUp</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">total_data</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> /</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> i</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">, </span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">0</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">) </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">&amp;</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"个文件，\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> _</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">                &amp;</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"点击“确定”开始分割，点击“取消”返回\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> vbOKCancel</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">, </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"确认\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">) </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> vbOK</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\"> Then</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">        Filename</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\"> Application</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">.</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\\">InputBox</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">prompt</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"请输入分割后的文件主名，默认为“分割文件”\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> Title</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"选择\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> Default</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"分割文件\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">)</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">        With</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\"> Application</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">.</span><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">FileDialog</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">msoFileDialogFolderPicker</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">)  </span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">'获取分割后的文件存储路径</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">            If</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> .</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">Show</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\"> False</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\"> Then</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\"> Exit Sub</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">                path</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> .</span><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">SelectedItems</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">1</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">) </span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">&amp;</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"\\\\\\"</span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\"> '加入\\"\\\\\\",否则，文件会被存储到选定路径的上一层</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\\">        End</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\"> With</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\">        Application</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">.</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">ScreenUpdating</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\"> False</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">        k</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\"> 0</span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">   '第几次分割输出，用于标识分割文件次数</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">        For</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> n</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> m</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\"> To</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> total_data Step i   </span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">'从开始分割的行往下计数</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">            Set </span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">data_areas</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\"> Range</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">Cells</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">n</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> r</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">), </span><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">Cells</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">n</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> +</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> i</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> -</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\"> 1</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> j</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">))   </span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">'设置每次循环体内的分割数据主体</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\">            Application</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">.</span><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">Union</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">title_area</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> data_areas</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">).</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">Select</span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">           '把表头区域以及本次循环体内的数据区域进行合并</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">            Selection.Copy</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">            Workbooks.</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\\">Add</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">            Selection.PasteSpecial Paste:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">xlPasteAllUsingSourceTheme</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> Operation</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">xlNone</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> _</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">            ,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> SkipBlanks</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">False</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> Transpose</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">False</span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">      '特殊粘贴：包含源格式的粘贴，以便保持所有格式一致</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">           k</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> k</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> +</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\"> 1</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">           ActiveWorkbook.SaveAs </span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\">Filename</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">path</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> &amp;</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> Filename</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> &amp;</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"_\\"</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> &amp;</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> k</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> &amp;</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\".xlsx\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> FileFormat</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> _</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">            xlOpenXMLWorkbook,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> CreateBackup</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">:</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\">False</span><span style=\\"--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">      '按照既有的文件名、路径、循环次数合并起来存储文件</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">            ActiveWindow.Close</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">        Next</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> n</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#005CC5;--shiki-dark:#56B6C2\\">        MsgBox</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> \\"文件分割完毕！\\"</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\"> vbDefaultButton1</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">, </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">\\"提示\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">    End If</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#005CC5;--shiki-dark:#E5C07B\\">    Application</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">.</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">ScreenUpdating</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#ABB2BF\\"> =</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\"> True</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#D73A49;--shiki-dark:#C678DD\\">End Sub</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>"}`);export{B as comp,r as data};
